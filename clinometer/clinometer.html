<!DOCTYPE html>
<!-- Generated by Cython 3.1.6 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: clinometer.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #3D7B7B; font-style: italic } /* Comment */
.cython .err { border: 1px solid #F00 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666 } /* Operator */
.cython .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #9C6500 } /* Comment.Preproc */
.cython .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cython .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.cython .gr { color: #E40000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #008400 } /* Generic.Inserted */
.cython .go { color: #717171 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #04D } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #687822 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #00F; font-weight: bold } /* Name.Class */
.cython .no { color: #800 } /* Name.Constant */
.cython .nd { color: #A2F } /* Name.Decorator */
.cython .ni { color: #717171; font-weight: bold } /* Name.Entity */
.cython .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.cython .nf { color: #00F } /* Name.Function */
.cython .nl { color: #767600 } /* Name.Label */
.cython .nn { color: #00F; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #A2F; font-weight: bold } /* Operator.Word */
.cython .w { color: #BBB } /* Text.Whitespace */
.cython .mb { color: #666 } /* Literal.Number.Bin */
.cython .mf { color: #666 } /* Literal.Number.Float */
.cython .mh { color: #666 } /* Literal.Number.Hex */
.cython .mi { color: #666 } /* Literal.Number.Integer */
.cython .mo { color: #666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #A45A77 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #00F } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.1.6</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="clinometer.c">clinometer.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="c">#cython: boundscheck=False</span></pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_test, __pyx_t_5) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: <span class="c">#cython: wraparound=False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: <span class="c">#cython: profile=False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: <span class="c">#cython: cdivision=True</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: <span class="c">#cython: infer_types=True</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: <span class="sd">&quot;&quot;&quot; If you want to profile this algorithm in more detail, set #cython: profile=True above  &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">009</span>: <span class="k">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_mstate_global-&gt;__pyx_n_u_numpy, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_np, __pyx_t_5) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">010</span>: <span class="k">from</span><span class="w"> </span><span class="nn">libc.math</span><span class="w"> </span><span class="k">cimport</span> <span class="n">fabs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: <span class="c"># ============================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: <span class="c">#  find_window_size()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: <span class="c"># ============================================================</span></pre>
<pre class="cython line score-95" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>: <span class="k">def</span><span class="w"> </span><span class="nf">find_window_size</span><span class="p">(</span><span class="n">double</span><span class="p">[:]</span> <span class="n">data</span><span class="p">,</span></pre>
<pre class='cython code score-95 '>/* Python wrapper */
static PyObject *__pyx_pw_10clinometer_10clinometer_1find_window_size(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10clinometer_10clinometer_find_window_size, "\n    Expands or shrinks the window size for each data point \n    until the difference in y-data ( |y[right] - y[left]| ) \n    matches the provided error. The window size is then used by\n    the next data point as a starting point. If the window has \n    to grow outside the imposed limit of Nmax (i.e.\n    |y[n+Nmax] - y[n-Nmax]| &lt; error), or if the algorithm gets\n    stuck in an infinite loop (e.g. with discontinuous data), \n    the function breaks and flags that datapoint as \n    insignificant (converged = 0).\n    ");
static PyMethodDef __pyx_mdef_10clinometer_10clinometer_1find_window_size = {"find_window_size", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10clinometer_10clinometer_1find_window_size, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10clinometer_10clinometer_find_window_size};
static PyObject *__pyx_pw_10clinometer_10clinometer_1find_window_size(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  __Pyx_memviewslice __pyx_v_data = { 0, 0, { 0 }, { 0 }, { 0 } };
  unsigned int __pyx_v_n;
  unsigned int __pyx_v_i;
  double __pyx_v_e;
  unsigned int __pyx_v_N;
  unsigned int __pyx_v_Nmax;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_window_size (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_data,&amp;__pyx_mstate_global-&gt;__pyx_n_u_n,&amp;__pyx_mstate_global-&gt;__pyx_n_u_i,&amp;__pyx_mstate_global-&gt;__pyx_n_u_e,&amp;__pyx_mstate_global-&gt;__pyx_n_u_N,&amp;__pyx_mstate_global-&gt;__pyx_n_u_Nmax,0};
  PyObject* values[6] = {0,0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "find_window_size", 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 6; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_window_size", 1, 6, 6, i); <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 6)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
      values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
      values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
      values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
    }
    __pyx_v_data = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_data.memview)) __PYX_ERR(0, 15, __pyx_L3_error)</span>
    __pyx_v_n = <span class='pyx_c_api'>__Pyx_PyLong_As_unsigned_int</span>(values[1]); if (unlikely((__pyx_v_n == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 16, __pyx_L3_error)</span>
    __pyx_v_i = <span class='pyx_c_api'>__Pyx_PyLong_As_unsigned_int</span>(values[2]); if (unlikely((__pyx_v_i == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L3_error)</span>
    __pyx_v_e = <span class='pyx_c_api'>__Pyx_PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_e == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L3_error)</span>
    __pyx_v_N = <span class='pyx_c_api'>__Pyx_PyLong_As_unsigned_int</span>(values[4]); if (unlikely((__pyx_v_N == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L3_error)</span>
    __pyx_v_Nmax = <span class='pyx_c_api'>__Pyx_PyLong_As_unsigned_int</span>(values[5]); if (unlikely((__pyx_v_Nmax == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_window_size", 1, 6, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_data, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("clinometer.clinometer.find_window_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10clinometer_10clinometer_find_window_size(__pyx_self, __pyx_v_data, __pyx_v_n, __pyx_v_i, __pyx_v_e, __pyx_v_N, __pyx_v_Nmax);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_data, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10clinometer_10clinometer_find_window_size(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_data, unsigned int __pyx_v_n, unsigned int __pyx_v_i, double __pyx_v_e, unsigned int __pyx_v_N, unsigned int __pyx_v_Nmax) {
  unsigned int __pyx_v_converged;
  unsigned int __pyx_v_leftlim;
  unsigned int __pyx_v_leftlim2;
  unsigned int __pyx_v_rightlim;
  unsigned int __pyx_v_rightlim2;
  unsigned int __pyx_v_counter;
  unsigned int __pyx_v_stepsize;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("clinometer.clinometer.find_window_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10clinometer_10clinometer_1find_window_size, 0, __pyx_mstate_global-&gt;__pyx_n_u_find_window_size, NULL, __pyx_mstate_global-&gt;__pyx_n_u_clinometer_clinometer, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[0]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_find_window_size, __pyx_t_5) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">016</span>:                      <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">n</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>:                      <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">i</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>:                      <span class="n">double</span> <span class="n">e</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>:                      <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">N</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>:                      <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">Nmax</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: <span class="sd">    Expands or shrinks the window size for each data point </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: <span class="sd">    until the difference in y-data ( |y[right] - y[left]| ) </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: <span class="sd">    matches the provided error. The window size is then used by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: <span class="sd">    the next data point as a starting point. If the window has </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: <span class="sd">    to grow outside the imposed limit of Nmax (i.e.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: <span class="sd">    |y[n+Nmax] - y[n-Nmax]| &lt; error), or if the algorithm gets</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: <span class="sd">    stuck in an infinite loop (e.g. with discontinuous data), </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>: <span class="sd">    the function breaks and flags that datapoint as </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>: <span class="sd">    insignificant (converged = 0).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">converged</span><span class="w"> </span><span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_converged = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">033</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">leftlim</span><span class="p">,</span> <span class="nf">leftlim2</span><span class="p">,</span> <span class="nf">rightlim</span><span class="p">,</span> <span class="nf">rightlim2</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">034</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">counter</span><span class="w"> </span><span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_counter = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">stepsize</span><span class="w"> </span><span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_stepsize = 1;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">int</span>[<span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-33 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_int32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_6 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_mstate_global-&gt;__pyx_int_4};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_5, __pyx_t_3, __pyx_callargs+2, 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 36, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 36, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">037</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>:     <span class="c"># Looping until the difference &gt; error</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">039</span>:     <span class="k">while</span> <span class="bp">True</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
</pre><pre class="cython line score-0">&#xA0;<span class="">040</span>:         <span class="c"># Infinite loop check</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>:         <span class="n">counter</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_counter = (__pyx_v_counter + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>:         <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">Nmax</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = (__pyx_v_counter &gt; (2 * __pyx_v_Nmax));
    if (__pyx_t_8) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">043</span>:             <span class="n">converged</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_converged = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">044</span>:             <span class="k">break</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L4_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>:         <span class="c"># Adjust window bounds</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>:         <span class="n">leftlim</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>    __pyx_v_leftlim = (__pyx_v_n - __pyx_v_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>:         <span class="n">leftlim2</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="n">stepsize</span></pre>
<pre class='cython code score-0 '>    __pyx_v_leftlim2 = ((__pyx_v_n - __pyx_v_i) - __pyx_v_stepsize);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:         <span class="n">rightlim</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>    __pyx_v_rightlim = (__pyx_v_n + __pyx_v_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>:         <span class="n">rightlim2</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="n">stepsize</span></pre>
<pre class='cython code score-0 '>    __pyx_v_rightlim2 = ((__pyx_v_n + __pyx_v_i) + __pyx_v_stepsize);
</pre><pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>:         <span class="c"># Bounds checking</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>:         <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = (__pyx_v_i &gt; __pyx_v_n);
    if (__pyx_t_8) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">054</span>:             <span class="n">leftlim</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_leftlim = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">055</span>:             <span class="n">rightlim</span> <span class="o">=</span> <span class="n">rightlim</span> <span class="o">-</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>      __pyx_v_rightlim = ((__pyx_v_rightlim - __pyx_v_n) + __pyx_v_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>:         <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="n">stepsize</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = ((__pyx_v_i + __pyx_v_stepsize) &gt; __pyx_v_n);
    if (__pyx_t_8) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>:             <span class="n">leftlim2</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_leftlim2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>:             <span class="n">rightlim2</span> <span class="o">=</span> <span class="n">rightlim2</span> <span class="o">-</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="n">stepsize</span></pre>
<pre class='cython code score-0 '>      __pyx_v_rightlim2 = (((__pyx_v_rightlim2 - __pyx_v_n) + __pyx_v_i) + __pyx_v_stepsize);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">059</span>:         <span class="k">if</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">N</span> <span class="o">-</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = ((__pyx_v_n + __pyx_v_i) &gt;= (__pyx_v_N - 1));
    if (__pyx_t_8) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:             <span class="n">rightlim</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_rightlim = (__pyx_v_N - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:             <span class="n">leftlim</span> <span class="o">=</span> <span class="n">leftlim</span> <span class="o">-</span> <span class="n">n</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="n">N</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_leftlim = ((((__pyx_v_leftlim - __pyx_v_n) - __pyx_v_i) + __pyx_v_N) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:         <span class="k">if</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="n">stepsize</span> <span class="o">&gt;=</span> <span class="n">N</span> <span class="o">-</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = (((__pyx_v_n + __pyx_v_i) + __pyx_v_stepsize) &gt;= (__pyx_v_N - 1));
    if (__pyx_t_8) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">063</span>:             <span class="n">rightlim2</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_rightlim2 = (__pyx_v_N - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">064</span>:             <span class="n">leftlim2</span> <span class="o">=</span> <span class="n">leftlim2</span> <span class="o">-</span> <span class="n">n</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="n">N</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_leftlim2 = ((((__pyx_v_leftlim2 - __pyx_v_n) - __pyx_v_i) + __pyx_v_N) - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">065</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>:         <span class="c"># Growing or shrinking window</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">067</span>:         <span class="k">if</span> <span class="n">fabs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">leftlim</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">rightlim</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_leftlim;
    __pyx_t_9 = __pyx_v_rightlim;
    __pyx_t_8 = (fabs(((*((double *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_6 * __pyx_v_data.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_9 * __pyx_v_data.strides[0]) ))))) &lt; __pyx_v_e);
    if (__pyx_t_8) {
/* … */
      goto __pyx_L10;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">068</span>:             <span class="c"># Is the window too small or just right?</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>:             <span class="k">if</span> <span class="n">fabs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">leftlim2</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">rightlim2</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">e</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = __pyx_v_leftlim2;
      __pyx_t_6 = __pyx_v_rightlim2;
      __pyx_t_8 = (fabs(((*((double *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_9 * __pyx_v_data.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_6 * __pyx_v_data.strides[0]) ))))) &gt;= __pyx_v_e);
      if (__pyx_t_8) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L4_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">071</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>:             <span class="c"># |y[n+Nmax] - y[n-Nmax]| &lt; error → stop</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">073</span>:             <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">Nmax</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = (__pyx_v_i &gt; __pyx_v_Nmax);
      if (__pyx_t_8) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">074</span>:                 <span class="n">converged</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>        __pyx_v_converged = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">075</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L4_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">076</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>:             <span class="c"># Increase window size</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>:             <span class="n">i</span> <span class="o">+=</span> <span class="n">stepsize</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + __pyx_v_stepsize);
</pre><pre class="cython line score-0">&#xA0;<span class="">079</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>:             <span class="c"># Is the window too large or just right?</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:             <span class="k">if</span> <span class="n">fabs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">leftlim2</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">rightlim2</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">e</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_6 = __pyx_v_leftlim2;
      __pyx_t_9 = __pyx_v_rightlim2;
      __pyx_t_8 = (fabs(((*((double *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_6 * __pyx_v_data.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_9 * __pyx_v_data.strides[0]) ))))) &lt;= __pyx_v_e);
      if (__pyx_t_8) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L4_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">083</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>:             <span class="c"># Need at least 3 points</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>:             <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">stepsize</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = (__pyx_v_i &lt;= __pyx_v_stepsize);
      if (__pyx_t_8) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L4_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">087</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>:             <span class="c"># Decrease window size</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>:             <span class="n">i</span> <span class="o">-=</span> <span class="n">stepsize</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i - __pyx_v_stepsize);
    }
    __pyx_L10:;
  }
  __pyx_L4_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">090</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>:     <span class="c"># Store results</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">092</span>:     <span class="n">out</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = 0;
  *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_out.data) + __pyx_t_10)) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">093</span>:     <span class="n">out</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">leftlim2</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = 1;
  *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_out.data) + __pyx_t_10)) )) = __pyx_v_leftlim2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>:     <span class="n">out</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">rightlim2</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = 2;
  *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_out.data) + __pyx_t_10)) )) = __pyx_v_rightlim2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>:     <span class="n">out</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">converged</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = 3;
  *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_out.data) + __pyx_t_10)) )) = __pyx_v_converged;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>:     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-21 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_9 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    assert(__pyx_t_4);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, __pyx__function);
    __pyx_t_9 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+__pyx_t_9, (2-__pyx_t_9) | (__pyx_t_9*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 96, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>: <span class="c"># ============================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>: <span class="c">#  scan_regression()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>: <span class="c"># ============================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>: </pre>
<pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>: <span class="k">def</span><span class="w"> </span><span class="nf">scan_regression</span><span class="p">(</span><span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">r_params</span><span class="p">,</span> <span class="nb">int</span> <span class="n">poly</span><span class="p">):</span></pre>
<pre class='cython code score-62 '>/* Python wrapper */
static PyObject *__pyx_pw_10clinometer_10clinometer_3scan_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10clinometer_10clinometer_2scan_regression, "\n    Performs OLS regression to estimate the gradient in each \n    data point using the regression parameters that were \n    gathered in the main function. This exploits the property \n    that sum[a -&gt; b] = sum[0 -&gt; b] - sum[0 -&gt; a-1]. The entire \n    operation is very similar to a scan operation common in\n    GPU/parallel programming.\n    ");
static PyMethodDef __pyx_mdef_10clinometer_10clinometer_3scan_regression = {"scan_regression", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10clinometer_10clinometer_3scan_regression, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10clinometer_10clinometer_2scan_regression};
static PyObject *__pyx_pw_10clinometer_10clinometer_3scan_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  __Pyx_memviewslice __pyx_v_r_params = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_poly;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scan_regression (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_r_params,&amp;__pyx_mstate_global-&gt;__pyx_n_u_poly,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "scan_regression", 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 2; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scan_regression", 1, 2, 2, i); <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
    }
    __pyx_v_r_params = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r_params.memview)) __PYX_ERR(0, 102, __pyx_L3_error)</span>
    __pyx_v_poly = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[1]); if (unlikely((__pyx_v_poly == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scan_regression", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_r_params, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("clinometer.clinometer.scan_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10clinometer_10clinometer_2scan_regression(__pyx_self, __pyx_v_r_params, __pyx_v_poly);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_r_params, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10clinometer_10clinometer_2scan_regression(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_r_params, int __pyx_v_poly) {
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_N;
  __Pyx_memviewslice __pyx_v_gradient = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_leftlim;
  int __pyx_v_rightlim;
  int __pyx_v_l;
  double __pyx_v_sumx;
  double __pyx_v_sumy;
  double __pyx_v_xx;
  double __pyx_v_xxx;
  double __pyx_v_xxxx;
  double __pyx_v_xy;
  double __pyx_v_xxy;
  double __pyx_v_a;
  double __pyx_v_b;
  double __pyx_v_x;
  PyObject *__pyx_v_K = 0;
  PyObject *__pyx_v_B = 0;
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("clinometer.clinometer.scan_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gradient, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_K);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_B);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_A);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10clinometer_10clinometer_3scan_regression, 0, __pyx_mstate_global-&gt;__pyx_n_u_scan_regression, NULL, __pyx_mstate_global-&gt;__pyx_n_u_clinometer_clinometer, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[1]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_scan_regression, __pyx_t_5) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">103</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>: <span class="sd">    Performs OLS regression to estimate the gradient in each </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>: <span class="sd">    data point using the regression parameters that were </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>: <span class="sd">    gathered in the main function. This exploits the property </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>: <span class="sd">    that sum[a -&gt; b] = sum[0 -&gt; b] - sum[0 -&gt; a-1]. The entire </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>: <span class="sd">    operation is very similar to a scan operation common in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>: <span class="sd">    GPU/parallel programming.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">Py_ssize_t</span> <span class="nf">n</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">Py_ssize_t</span> <span class="nf">N</span><span class="w"> </span><span class="o">=</span> <span class="n">r_params</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_r_params.shape[0]);
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">113</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">double</span>[<span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_t_3};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_6, __pyx_t_5, __pyx_callargs+2, 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_gradient = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">115</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">int</span> <span class="nf">leftlim</span><span class="p">,</span> <span class="nf">rightlim</span><span class="p">,</span> <span class="nf">l</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">double</span> <span class="nf">sumx</span><span class="p">,</span> <span class="nf">sumy</span><span class="p">,</span> <span class="nf">xx</span><span class="p">,</span> <span class="nf">xxx</span><span class="p">,</span> <span class="nf">xxxx</span><span class="p">,</span> <span class="nf">xy</span><span class="p">,</span> <span class="nf">xxy</span><span class="p">,</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span><span class="p">,</span> <span class="nf">x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">object</span> <span class="nf">K</span><span class="p">,</span> <span class="nf">B</span><span class="p">,</span> <span class="nf">A</span><span class="p">,</span> <span class="nf">X</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">118</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:     <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_N;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_n = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:         <span class="n">leftlim</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">4</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_n;
    __pyx_t_13 = 4;
    __pyx_v_leftlim = ((int)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_12 * __pyx_v_r_params.strides[0]) ) + __pyx_t_13 * __pyx_v_r_params.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:         <span class="n">rightlim</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">5</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_n;
    __pyx_t_12 = 5;
    __pyx_v_rightlim = ((int)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_13 * __pyx_v_r_params.strides[0]) ) + __pyx_t_12 * __pyx_v_r_params.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:         <span class="n">l</span> <span class="o">=</span> <span class="n">rightlim</span> <span class="o">-</span> <span class="n">leftlim</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_l = ((__pyx_v_rightlim - __pyx_v_leftlim) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:         <span class="n">x</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">9</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_n;
    __pyx_t_13 = 9;
    __pyx_v_x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_12 * __pyx_v_r_params.strides[0]) ) + __pyx_t_13 * __pyx_v_r_params.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">124</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>:         <span class="c"># Collect regression parameters</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:         <span class="k">if</span> <span class="n">leftlim</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = (__pyx_v_leftlim &gt; 0);
    if (__pyx_t_14) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:             <span class="n">sumx</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_params</span><span class="p">[</span><span class="n">leftlim</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_rightlim;
      __pyx_t_12 = 0;
      __pyx_t_15 = (__pyx_v_leftlim - 1);
      __pyx_t_16 = 0;
      __pyx_v_sumx = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_13 * __pyx_v_r_params.strides[0]) ) + __pyx_t_12 * __pyx_v_r_params.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_15 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:             <span class="n">sumy</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_params</span><span class="p">[</span><span class="n">leftlim</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_rightlim;
      __pyx_t_15 = 1;
      __pyx_t_12 = (__pyx_v_leftlim - 1);
      __pyx_t_13 = 1;
      __pyx_v_sumy = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_15 * __pyx_v_r_params.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_12 * __pyx_v_r_params.strides[0]) ) + __pyx_t_13 * __pyx_v_r_params.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:             <span class="n">xx</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_params</span><span class="p">[</span><span class="n">leftlim</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_rightlim;
      __pyx_t_12 = 2;
      __pyx_t_15 = (__pyx_v_leftlim - 1);
      __pyx_t_16 = 2;
      __pyx_v_xx = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_13 * __pyx_v_r_params.strides[0]) ) + __pyx_t_12 * __pyx_v_r_params.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_15 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>:             <span class="n">xy</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_params</span><span class="p">[</span><span class="n">leftlim</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_rightlim;
      __pyx_t_15 = 3;
      __pyx_t_12 = (__pyx_v_leftlim - 1);
      __pyx_t_13 = 3;
      __pyx_v_xy = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_15 * __pyx_v_r_params.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_12 * __pyx_v_r_params.strides[0]) ) + __pyx_t_13 * __pyx_v_r_params.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:             <span class="n">xxx</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_params</span><span class="p">[</span><span class="n">leftlim</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">6</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_rightlim;
      __pyx_t_12 = 6;
      __pyx_t_15 = (__pyx_v_leftlim - 1);
      __pyx_t_16 = 6;
      __pyx_v_xxx = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_13 * __pyx_v_r_params.strides[0]) ) + __pyx_t_12 * __pyx_v_r_params.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_15 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:             <span class="n">xxxx</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">7</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_params</span><span class="p">[</span><span class="n">leftlim</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_rightlim;
      __pyx_t_15 = 7;
      __pyx_t_12 = (__pyx_v_leftlim - 1);
      __pyx_t_13 = 7;
      __pyx_v_xxxx = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_15 * __pyx_v_r_params.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_12 * __pyx_v_r_params.strides[0]) ) + __pyx_t_13 * __pyx_v_r_params.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:             <span class="n">xxy</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">8</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_params</span><span class="p">[</span><span class="n">leftlim</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_rightlim;
      __pyx_t_12 = 8;
      __pyx_t_15 = (__pyx_v_leftlim - 1);
      __pyx_t_16 = 8;
      __pyx_v_xxy = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_13 * __pyx_v_r_params.strides[0]) ) + __pyx_t_12 * __pyx_v_r_params.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_15 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">134</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:             <span class="n">sumx</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_16 = __pyx_v_rightlim;
      __pyx_t_15 = 0;
      __pyx_v_sumx = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_15 * __pyx_v_r_params.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:             <span class="n">sumy</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_rightlim;
      __pyx_t_16 = 1;
      __pyx_v_sumy = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_15 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:             <span class="n">xx</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_rightlim;
      __pyx_t_15 = 2;
      __pyx_v_xx = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_15 * __pyx_v_r_params.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">138</span>:             <span class="n">xy</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_rightlim;
      __pyx_t_16 = 3;
      __pyx_v_xy = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_15 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>:             <span class="n">xxx</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">6</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_rightlim;
      __pyx_t_15 = 6;
      __pyx_v_xxx = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_15 * __pyx_v_r_params.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">140</span>:             <span class="n">xxxx</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_rightlim;
      __pyx_t_16 = 7;
      __pyx_v_xxxx = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_15 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">141</span>:             <span class="n">xxy</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">rightlim</span><span class="p">,</span> <span class="mf">8</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_rightlim;
      __pyx_t_15 = 8;
      __pyx_v_xxy = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_15 * __pyx_v_r_params.strides[1]) )));
    }
    __pyx_L5:;
</pre><pre class="cython line score-0">&#xA0;<span class="">142</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:         <span class="k">if</span> <span class="n">poly</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = (__pyx_v_poly == 0);
    if (__pyx_t_14) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:             <span class="n">a</span> <span class="o">=</span> <span class="n">l</span> <span class="o">*</span> <span class="n">xy</span> <span class="o">-</span> <span class="p">(</span><span class="n">sumx</span> <span class="o">*</span> <span class="n">sumy</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_a = ((__pyx_v_l * __pyx_v_xy) - (__pyx_v_sumx * __pyx_v_sumy));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:             <span class="n">b</span> <span class="o">=</span> <span class="n">l</span> <span class="o">*</span> <span class="n">xx</span> <span class="o">-</span> <span class="p">(</span><span class="n">sumx</span> <span class="o">*</span> <span class="n">sumx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_b = ((__pyx_v_l * __pyx_v_xx) - (__pyx_v_sumx * __pyx_v_sumx));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:             <span class="n">gradient</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = (__pyx_v_b == 0.0);
      if (__pyx_t_14) {
        __pyx_t_17 = 0.0;
      } else {
        __pyx_t_17 = (__pyx_v_a / __pyx_v_b);
      }
      __pyx_t_15 = __pyx_v_n;
      *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_gradient.data) + __pyx_t_15)) )) = __pyx_t_17;
</pre><pre class="cython line score-0">&#xA0;<span class="">147</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>:             <span class="c"># Small matrices, so np.linalg.inv is acceptable</span></pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:             <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">l</span><span class="p">,</span> <span class="n">sumx</span><span class="p">,</span> <span class="n">xx</span><span class="p">],</span></pre>
<pre class='cython code score-45 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_4 = __pyx_t_6;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      __pyx_t_3 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_array);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_l);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_19 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sumx);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
      __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_xx);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_21 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_2) != (0)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_21, 1, __pyx_t_19) != (0)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_21, 2, __pyx_t_20) != (0)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>;
      __pyx_t_2 = 0;
      __pyx_t_19 = 0;
      __pyx_t_20 = 0;
/* … */
      __pyx_t_20 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_21) != (0)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_22) != (0)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_20, 2, __pyx_t_23) != (0)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>;
      __pyx_t_21 = 0;
      __pyx_t_22 = 0;
      __pyx_t_23 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:                                         <span class="p">[</span><span class="n">sumx</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">xxx</span><span class="p">],</span></pre>
<pre class='cython code score-26 '>      __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sumx);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_19 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_xx);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_xxx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_22 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_20) != (0)) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_22, 1, __pyx_t_19) != (0)) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_22, 2, __pyx_t_2) != (0)) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>;
      __pyx_t_20 = 0;
      __pyx_t_19 = 0;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:                                         <span class="p">[</span><span class="n">xx</span><span class="p">,</span> <span class="n">xxx</span><span class="p">,</span> <span class="n">xxxx</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span></pre>
<pre class='cython code score-58 '>      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_xx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_19 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_xxx);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
      __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_xxxx);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_23 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_2) != (0)) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_23, 1, __pyx_t_19) != (0)) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_23, 2, __pyx_t_20) != (0)) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>;
      __pyx_t_2 = 0;
      __pyx_t_19 = 0;
      __pyx_t_20 = 0;
/* … */
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      __pyx_t_7 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_18))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_18);
        assert(__pyx_t_3);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_18, __pyx__function);
        __pyx_t_7 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_3, __pyx_t_20};
        __pyx_t_23 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
        if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_22, __pyx_t_23, __pyx_callargs+2, 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_18, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_23);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      }
      __pyx_t_7 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_5};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_inv, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_K, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:             <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sumy</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">xxy</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-58 '>      __pyx_t_6 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sumy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_18 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_xy);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
      __pyx_t_23 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_xxy);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      __pyx_t_22 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_5) != (0)) <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_22, 1, __pyx_t_18) != (0)) <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_22, 2, __pyx_t_23) != (0)) <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>;
      __pyx_t_5 = 0;
      __pyx_t_18 = 0;
      __pyx_t_23 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      __pyx_t_7 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        assert(__pyx_t_6);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
        __pyx_t_7 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_6, __pyx_t_22};
        __pyx_t_23 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
        if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_18, __pyx_t_23, __pyx_callargs+2, 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_23);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_B, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:             <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span></pre>
<pre class='cython code score-20 '>      __pyx_t_4 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 153, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_dot);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 153, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      __pyx_t_7 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_18))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_18);
        assert(__pyx_t_4);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_18, __pyx__function);
        __pyx_t_7 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_K, __pyx_v_B};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_18, __pyx_callargs+__pyx_t_7, (3-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 153, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_A, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:             <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">x</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-50 '>      __pyx_t_18 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_array);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_x));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_22 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_float_0_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_float_0_0);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_22, 0, __pyx_mstate_global-&gt;__pyx_float_0_0) != (0)) <span class='error_goto'>__PYX_ERR(0, 154, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_float_1_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_float_1_0);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_22, 1, __pyx_mstate_global-&gt;__pyx_float_1_0) != (0)) <span class='error_goto'>__PYX_ERR(0, 154, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_22, 2, __pyx_t_4) != (0)) <span class='error_goto'>__PYX_ERR(0, 154, __pyx_L1_error)</span>;
      __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_7 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_23))) {
        __pyx_t_18 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_23);
        assert(__pyx_t_18);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_23);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_23, __pyx__function);
        __pyx_t_7 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_18, __pyx_t_22};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_6, __pyx_t_4, __pyx_callargs+2, 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 154, __pyx_L1_error)</span>
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_23, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 154, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_X, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:             <span class="n">gradient</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>      __pyx_t_23 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_dot);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_7 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_23 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        assert(__pyx_t_23);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_23);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, __pyx__function);
        __pyx_t_7 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_23, __pyx_v_A, __pyx_v_X};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+__pyx_t_7, (3-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 155, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_17 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 155, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_15 = __pyx_v_n;
      *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_gradient.data) + __pyx_t_15)) )) = __pyx_t_17;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">156</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>:     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">gradient</span><span class="p">)</span></pre>
<pre class='cython code score-21 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_t_23 = __pyx_memoryview_fromslice(__pyx_v_gradient, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_6);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_23};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>: <span class="c"># ============================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>: <span class="c">#  estimate_slope()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">162</span>: <span class="c"># ============================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">163</span>: </pre>
<pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>: <span class="k">def</span><span class="w"> </span><span class="nf">estimate_slope</span><span class="p">(</span><span class="n">double</span><span class="p">[:]</span> <span class="n">data</span><span class="p">,</span></pre>
<pre class='cython code score-72 '>/* Python wrapper */
static PyObject *__pyx_pw_10clinometer_10clinometer_5estimate_slope(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10clinometer_10clinometer_4estimate_slope, "\n    Estimate the local slope of `data` over `time` using an adaptive window.\n\n    Parameters\n    ----------\n    data : 1D array of float64\n        The dependent variable (y).\n    time : 1D array of float64\n        The independent variable (x).\n    e : float\n        Error tolerance for window expansion.\n    Nmax : int\n        Maximum allowed half-window size.\n    poly : {0, 1}\n        0 for linear regression, 1 for quadratic. \n\n    Returns\n    -------\n    np.ndarray (4, N)\n        Rows:\n        [0] = estimated slope\n        [1] = window size\n        [2] = |\316\224y|\n        [3] = convergence flag (1 or 0)\n    ");
static PyMethodDef __pyx_mdef_10clinometer_10clinometer_5estimate_slope = {"estimate_slope", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10clinometer_10clinometer_5estimate_slope, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10clinometer_10clinometer_4estimate_slope};
static PyObject *__pyx_pw_10clinometer_10clinometer_5estimate_slope(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  __Pyx_memviewslice __pyx_v_data = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_time = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_e;
  unsigned int __pyx_v_Nmax;
  int __pyx_v_poly;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("estimate_slope (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_data,&amp;__pyx_mstate_global-&gt;__pyx_n_u_time,&amp;__pyx_mstate_global-&gt;__pyx_n_u_e,&amp;__pyx_mstate_global-&gt;__pyx_n_u_Nmax,&amp;__pyx_mstate_global-&gt;__pyx_n_u_poly,0};
  PyObject* values[5] = {0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "estimate_slope", 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 5; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("estimate_slope", 1, 5, 5, i); <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
      values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
      values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
    }
    __pyx_v_data = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_data.memview)) __PYX_ERR(0, 164, __pyx_L3_error)</span>
    __pyx_v_time = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_time.memview)) __PYX_ERR(0, 165, __pyx_L3_error)</span>
    __pyx_v_e = <span class='pyx_c_api'>__Pyx_PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_e == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 166, __pyx_L3_error)</span>
    __pyx_v_Nmax = <span class='pyx_c_api'>__Pyx_PyLong_As_unsigned_int</span>(values[3]); if (unlikely((__pyx_v_Nmax == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 167, __pyx_L3_error)</span>
    __pyx_v_poly = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[4]); if (unlikely((__pyx_v_poly == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("estimate_slope", 1, 5, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_data, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_time, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("clinometer.clinometer.estimate_slope", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10clinometer_10clinometer_4estimate_slope(__pyx_self, __pyx_v_data, __pyx_v_time, __pyx_v_e, __pyx_v_Nmax, __pyx_v_poly);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_data, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_time, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10clinometer_10clinometer_4estimate_slope(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_data, __Pyx_memviewslice __pyx_v_time, double __pyx_v_e, unsigned int __pyx_v_Nmax, int __pyx_v_poly) {
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_j;
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_leftlim;
  unsigned int __pyx_v_rightlim;
  unsigned int __pyx_v_converged;
  unsigned int __pyx_v_diff;
  unsigned int __pyx_v_N;
  double __pyx_v_x;
  double __pyx_v_y;
  __Pyx_memviewslice __pyx_v_win = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_gradient = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r_params = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10clinometer_10clinometer_5estimate_slope, 0, __pyx_mstate_global-&gt;__pyx_n_u_estimate_slope, NULL, __pyx_mstate_global-&gt;__pyx_n_u_clinometer_clinometer, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[2]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_estimate_slope, __pyx_t_5) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">165</span>:                    <span class="n">double</span><span class="p">[:]</span> <span class="n">time</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>:                    <span class="n">double</span> <span class="n">e</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>:                    <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">Nmax</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>:                    <span class="nb">int</span> <span class="n">poly</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>: <span class="sd">    Estimate the local slope of `data` over `time` using an adaptive window.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>: <span class="sd">    data : 1D array of float64</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>: <span class="sd">        The dependent variable (y).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>: <span class="sd">    time : 1D array of float64</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>: <span class="sd">        The independent variable (x).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>: <span class="sd">    e : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>: <span class="sd">        Error tolerance for window expansion.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>: <span class="sd">    Nmax : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">181</span>: <span class="sd">        Maximum allowed half-window size.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>: <span class="sd">    poly : {0, 1}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>: <span class="sd">        0 for linear regression, 1 for quadratic. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>: <span class="sd">    np.ndarray (4, N)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>: <span class="sd">        Rows:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">189</span>: <span class="sd">        [0] = estimated slope</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">190</span>: <span class="sd">        [1] = window size</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>: <span class="sd">        [2] = |Δy|</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>: <span class="sd">        [3] = convergence flag (1 or 0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">Py_ssize_t</span> <span class="nf">n</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">i</span><span class="w"> </span><span class="o">=</span> <span class="mf">1</span><span class="p">,</span> <span class="n">leftlim</span><span class="p">,</span> <span class="n">rightlim</span><span class="p">,</span> <span class="n">converged</span><span class="p">,</span> <span class="n">diff</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">N</span><span class="w"> </span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_data.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">197</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">double</span> <span class="nf">x</span><span class="p">,</span> <span class="nf">y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">199</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">int</span>[<span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">win</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">200</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">double</span>[<span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">gradient</span></pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">r_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mf">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-46 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyLong_From_unsigned_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3) != (0)) <span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_int_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_int_10);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_mstate_global-&gt;__pyx_int_10) != (0)) <span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_t_5};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_6, __pyx_t_3, __pyx_callargs+2, 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_r_params = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:     <span class="k">cdef</span><span class="w"> </span><span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-46 '>  __pyx_t_4 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyLong_From_unsigned_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3) != (0)) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_int_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_mstate_global-&gt;__pyx_int_4) != (0)) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    assert(__pyx_t_4);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, __pyx_t_5};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_2, __pyx_t_3, __pyx_callargs+2, 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_6, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">203</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">204</span>:     <span class="c"># Loop over all data points</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>:     <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_N;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_n = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">206</span>:         <span class="c"># Window properties</span></pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:         <span class="n">win</span> <span class="o">=</span> <span class="n">find_window_size</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">Nmax</span><span class="p">)</span></pre>
<pre class='cython code score-41 '>    __pyx_t_6 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_find_window_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_data, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyLong_From_unsigned_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_e);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyLong_From_unsigned_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_From_unsigned_int</span>(__pyx_v_Nmax);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_7 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_6);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_7 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[7] = {__pyx_t_6, __pyx_t_2, __pyx_t_5, __pyx_t_4, __pyx_t_12, __pyx_t_13, __pyx_t_14};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_7, (7-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_win, 1);
    __pyx_v_win = __pyx_t_15;
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         <span class="n">i</span> <span class="o">=</span> <span class="n">win</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = 0;
    __pyx_v_i = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_win.data) + __pyx_t_16)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:         <span class="n">leftlim</span> <span class="o">=</span> <span class="n">win</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = 1;
    __pyx_v_leftlim = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_win.data) + __pyx_t_16)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:         <span class="n">rightlim</span> <span class="o">=</span> <span class="n">win</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = 2;
    __pyx_v_rightlim = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_win.data) + __pyx_t_16)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:         <span class="n">converged</span> <span class="o">=</span> <span class="n">win</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = 3;
    __pyx_v_converged = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_win.data) + __pyx_t_16)) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">213</span>:         <span class="c"># Cumulative sums for regression</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:         <span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">n</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n;
    __pyx_v_x = (*((double *) ( /* dim=0 */ (__pyx_v_time.data + __pyx_t_16 * __pyx_v_time.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:         <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n;
    __pyx_v_y = (*((double *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_16 * __pyx_v_data.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:         <span class="n">j</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mf">1</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mf">0</span> <span class="k">else</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = (__pyx_v_n &gt; 0);
    if (__pyx_t_18) {
      __pyx_t_17 = (__pyx_v_n - 1);
    } else {
      __pyx_t_17 = 0;
    }
    __pyx_v_j = __pyx_t_17;
</pre><pre class="cython line score-0">&#xA0;<span class="">217</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:         <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_j;
    __pyx_t_19 = 0;
    __pyx_t_20 = __pyx_v_n;
    __pyx_t_21 = 0;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_20 * __pyx_v_r_params.strides[0]) ) + __pyx_t_21 * __pyx_v_r_params.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_19 * __pyx_v_r_params.strides[1]) ))) + __pyx_v_x);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:         <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_j;
    __pyx_t_16 = 1;
    __pyx_t_21 = __pyx_v_n;
    __pyx_t_20 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_21 * __pyx_v_r_params.strides[0]) ) + __pyx_t_20 * __pyx_v_r_params.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_19 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) ))) + __pyx_v_y);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:         <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_j;
    __pyx_t_19 = 2;
    __pyx_t_20 = __pyx_v_n;
    __pyx_t_21 = 2;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_20 * __pyx_v_r_params.strides[0]) ) + __pyx_t_21 * __pyx_v_r_params.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_19 * __pyx_v_r_params.strides[1]) ))) + (__pyx_v_x * __pyx_v_x));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:         <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_j;
    __pyx_t_16 = 3;
    __pyx_t_21 = __pyx_v_n;
    __pyx_t_20 = 3;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_21 * __pyx_v_r_params.strides[0]) ) + __pyx_t_20 * __pyx_v_r_params.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_19 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) ))) + (__pyx_v_x * __pyx_v_y));
</pre><pre class="cython line score-0">&#xA0;<span class="">222</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:         <span class="k">if</span> <span class="n">poly</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = (__pyx_v_poly != 0);
    if (__pyx_t_18) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:             <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">6</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mf">3</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_j;
      __pyx_t_19 = 6;
      __pyx_t_20 = __pyx_v_n;
      __pyx_t_21 = 6;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_20 * __pyx_v_r_params.strides[0]) ) + __pyx_t_21 * __pyx_v_r_params.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_19 * __pyx_v_r_params.strides[1]) ))) + pow(__pyx_v_x, 3.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:             <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">7</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mf">4</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_j;
      __pyx_t_16 = 7;
      __pyx_t_21 = __pyx_v_n;
      __pyx_t_20 = 7;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_21 * __pyx_v_r_params.strides[0]) ) + __pyx_t_20 * __pyx_v_r_params.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_19 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) ))) + pow(__pyx_v_x, 4.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:             <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_params</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">8</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_j;
      __pyx_t_19 = 8;
      __pyx_t_20 = __pyx_v_n;
      __pyx_t_21 = 8;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_20 * __pyx_v_r_params.strides[0]) ) + __pyx_t_21 * __pyx_v_r_params.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_19 * __pyx_v_r_params.strides[1]) ))) + ((__pyx_v_x * __pyx_v_x) * __pyx_v_y));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:             <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_16 = 9;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_19 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) )) = __pyx_v_x;
</pre><pre class="cython line score-0">&#xA0;<span class="">228</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:         <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">leftlim</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n;
    __pyx_t_19 = 4;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_16 * __pyx_v_r_params.strides[0]) ) + __pyx_t_19 * __pyx_v_r_params.strides[1]) )) = __pyx_v_leftlim;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:         <span class="n">r_params</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">rightlim</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_n;
    __pyx_t_16 = 5;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r_params.data + __pyx_t_19 * __pyx_v_r_params.strides[0]) ) + __pyx_t_16 * __pyx_v_r_params.strides[1]) )) = __pyx_v_rightlim;
</pre><pre class="cython line score-0">&#xA0;<span class="">231</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">232</span>:         <span class="c"># Store window size, delta y, and convergence flag</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:         <span class="n">diff</span> <span class="o">=</span> <span class="n">rightlim</span> <span class="o">-</span> <span class="n">leftlim</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_diff = ((__pyx_v_rightlim - __pyx_v_leftlim) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:         <span class="n">out</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n;
    __pyx_t_19 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_16 * __pyx_v_out.strides[0]) ) + __pyx_t_19 * __pyx_v_out.strides[1]) )) = __pyx_v_diff;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:         <span class="n">out</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">leftlim</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">rightlim</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_leftlim;
    __pyx_t_22 = __pyx_v_rightlim;
    __pyx_t_19 = __pyx_v_n;
    __pyx_t_16 = 2;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_19 * __pyx_v_out.strides[0]) ) + __pyx_t_16 * __pyx_v_out.strides[1]) )) = fabs(((*((double *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_7 * __pyx_v_data.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_data.data + __pyx_t_22 * __pyx_v_data.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:         <span class="n">out</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">converged</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n;
    __pyx_t_19 = 3;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_16 * __pyx_v_out.strides[0]) ) + __pyx_t_19 * __pyx_v_out.strides[1]) )) = __pyx_v_converged;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">237</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">238</span>:     <span class="c"># Regression scan</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:     <span class="n">gradient</span> <span class="o">=</span> <span class="n">scan_regression</span><span class="p">(</span><span class="n">r_params</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>  __pyx_t_3 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_mstate_global-&gt;__pyx_n_u_scan_regression);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_r_params, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_poly);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_22 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
    assert(__pyx_t_3);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, __pyx__function);
    __pyx_t_22 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_13, __pyx_t_12};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_14, __pyx_callargs+__pyx_t_22, (3-__pyx_t_22) | (__pyx_t_22*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_23.memview)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_gradient = __pyx_t_23;
  __pyx_t_23.memview = NULL;
  __pyx_t_23.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:     <span class="n">out</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">[:]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_24.data = __pyx_v_out.data;
  __pyx_t_24.memview = __pyx_v_out.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_24, 1);
  __pyx_t_24.shape[0] = __pyx_v_out.shape[0];
__pyx_t_24.strides[0] = __pyx_v_out.strides[0];
    __pyx_t_24.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_out.strides[1];
        __pyx_t_24.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_v_gradient, __pyx_t_24, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_24, 1);
  __pyx_t_24.memview = NULL; __pyx_t_24.data = NULL;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="o">.</span><span class="n">T</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_14 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_mstate_global-&gt;__pyx_n_u_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_22 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
    assert(__pyx_t_14);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, __pyx__function);
    __pyx_t_22 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_14, __pyx_t_12};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_13, __pyx_callargs+__pyx_t_22, (2-__pyx_t_22) | (__pyx_t_22*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_n_u_T);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_13;
  __pyx_t_13 = 0;
  goto __pyx_L0;
</pre></div></body></html>
